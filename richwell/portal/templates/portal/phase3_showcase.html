{% extends "portal/base.html" %}

{% block title %}Phase 3 Components Showcase - Richwell School Portal{% endblock %}

{% block content %}
<div class="space-y-6" x-data="{ showSidebar: false, showRightSidebar: false }">

    <!-- Page Header -->
    {% include "components/organisms/page_header.html" with title="Phase 3 Components" subtitle="Advanced UI Components - Sidebar, Wizard, Rich Text Editor" %}

    <!-- Introduction -->
    <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-xl font-semibold mb-4">Advanced Components Available</h3>
        <p class="text-gray-600 mb-4">
            This page demonstrates the new advanced UI components added in Phase 3:
        </p>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
            <li><strong>Sidebar Organism</strong> - Slide-out navigation drawer from left or right</li>
            <li><strong>Wizard Organism</strong> - Multi-step guided workflow with progress tracking</li>
            <li><strong>Rich Text Editor Molecule</strong> - WYSIWYG content editing with formatting toolbar</li>
        </ul>
    </div>

    <!-- Sidebar Demo -->
    <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-xl font-semibold mb-4">Sidebar Component</h3>
        <p class="text-gray-600 mb-4">Click the buttons below to open sidebars from different positions:</p>

        <div class="flex flex-wrap gap-4">
            <!-- Left Sidebar Trigger -->
            <button
                @click="showSidebar = true"
                class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"
            >
                Open Left Sidebar
            </button>

            <!-- Right Sidebar Trigger -->
            <button
                @click="showRightSidebar = true"
                class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition"
            >
                Open Right Sidebar
            </button>

            <!-- Event-based trigger -->
            <button
                @click="$dispatch('open-sidebar-notifications')"
                class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition"
            >
                Open Notifications (Event-based)
            </button>
        </div>

        <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
            <h4 class="font-semibold text-blue-900 mb-2">Features:</h4>
            <ul class="text-sm text-blue-800 space-y-1 list-disc list-inside">
                <li>Slides in from left or right</li>
                <li>Backdrop overlay with click-to-close</li>
                <li>ESC key to close</li>
                <li>Smooth animations</li>
                <li>Multiple size options (sm, md, lg, xl)</li>
                <li>Body scroll lock when open</li>
                <li>Accessible with ARIA attributes</li>
            </ul>
        </div>
    </div>

    <!-- Left Sidebar -->
    <div x-show="showSidebar">
        <div
            x-data="{
                open: showSidebar,
                init() {
                    this.$watch('showSidebar', value => { this.open = value });
                    this.$watch('open', value => { showSidebar = value });
                }
            }"
            @keydown.escape.window="open = false"
            x-show="open"
            x-cloak
        >
            <!-- Backdrop -->
            <div
                x-show="open"
                x-transition:enter="transition-opacity ease-linear duration-300"
                x-transition:enter-start="opacity-0"
                x-transition:enter-end="opacity-100"
                x-transition:leave="transition-opacity ease-linear duration-300"
                x-transition:leave-start="opacity-100"
                x-transition:leave-end="opacity-0"
                @click="open = false"
                class="fixed inset-0 bg-gray-900 bg-opacity-50 z-40"
            ></div>

            <!-- Sidebar Panel -->
            <div
                x-show="open"
                x-transition:enter="transform transition ease-in-out duration-300"
                x-transition:enter-start="-translate-x-full"
                x-transition:enter-end="translate-x-0"
                x-transition:leave="transform transition ease-in-out duration-300"
                x-transition:leave-start="translate-x-0"
                x-transition:leave-end="-translate-x-full"
                class="fixed left-0 top-0 bottom-0 w-80 z-50 bg-white shadow-xl overflow-y-auto"
            >
                <!-- Header -->
                <div class="sticky top-0 z-10 bg-white border-b border-gray-200 px-6 py-4">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold text-gray-900">Navigation Menu</h2>
                        <button @click="open = false" class="text-gray-400 hover:text-gray-500">
                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Content -->
                <div class="px-6 py-4">
                    <nav class="space-y-1">
                        <a href="#" class="flex items-center px-4 py-3 text-sm font-medium text-gray-900 bg-gray-100 rounded-lg">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                            </svg>
                            Dashboard
                        </a>
                        <a href="#" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                            </svg>
                            Courses
                        </a>
                        <a href="#" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                            </svg>
                            Assignments
                        </a>
                        <a href="#" class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                            </svg>
                            Grades
                        </a>
                    </nav>
                </div>

                <!-- Footer -->
                <div class="sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4">
                    <button @click="open = false" class="w-full px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                        Close Menu
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Right Sidebar -->
    <div x-show="showRightSidebar">
        <div
            x-data="{
                open: showRightSidebar,
                init() {
                    this.$watch('showRightSidebar', value => { this.open = value });
                    this.$watch('open', value => { showRightSidebar = value });
                }
            }"
            @keydown.escape.window="open = false"
            x-show="open"
            x-cloak
        >
            <!-- Backdrop -->
            <div
                x-show="open"
                x-transition:enter="transition-opacity ease-linear duration-300"
                x-transition:enter-start="opacity-0"
                x-transition:enter-end="opacity-100"
                x-transition:leave="transition-opacity ease-linear duration-300"
                x-transition:leave-start="opacity-100"
                x-transition:leave-end="opacity-0"
                @click="open = false"
                class="fixed inset-0 bg-gray-900 bg-opacity-50 z-40"
            ></div>

            <!-- Sidebar Panel -->
            <div
                x-show="open"
                x-transition:enter="transform transition ease-in-out duration-300"
                x-transition:enter-start="translate-x-full"
                x-transition:enter-end="translate-x-0"
                x-transition:leave="transform transition ease-in-out duration-300"
                x-transition:leave-start="translate-x-0"
                x-transition:leave-end="translate-x-full"
                class="fixed right-0 top-0 bottom-0 w-96 z-50 bg-white shadow-xl overflow-y-auto"
            >
                <!-- Header -->
                <div class="sticky top-0 z-10 bg-white border-b border-gray-200 px-6 py-4">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-semibold text-gray-900">User Profile</h2>
                        <button @click="open = false" class="text-gray-400 hover:text-gray-500">
                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Content -->
                <div class="px-6 py-4">
                    <div class="text-center mb-6">
                        <div class="w-24 h-24 bg-blue-500 rounded-full mx-auto mb-4 flex items-center justify-center text-white text-3xl font-bold">
                            JD
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900">John Doe</h3>
                        <p class="text-sm text-gray-600">Student ID: 2021-00123</p>
                    </div>

                    <div class="space-y-4">
                        <div class="border-b border-gray-200 pb-4">
                            <p class="text-sm font-medium text-gray-500">Email</p>
                            <p class="text-sm text-gray-900">john.doe@example.com</p>
                        </div>
                        <div class="border-b border-gray-200 pb-4">
                            <p class="text-sm font-medium text-gray-500">Program</p>
                            <p class="text-sm text-gray-900">BS Computer Science</p>
                        </div>
                        <div class="border-b border-gray-200 pb-4">
                            <p class="text-sm font-medium text-gray-500">Year Level</p>
                            <p class="text-sm text-gray-900">3rd Year</p>
                        </div>
                        <div class="border-b border-gray-200 pb-4">
                            <p class="text-sm font-medium text-gray-500">GPA</p>
                            <p class="text-sm text-gray-900">3.75</p>
                        </div>
                    </div>

                    <div class="mt-6">
                        <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            Edit Profile
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Wizard Demo -->
    <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-xl font-semibold mb-4">Wizard Component</h3>
        <p class="text-gray-600 mb-6">Multi-step guided workflow with progress tracking:</p>

        <!-- Wizard Component -->
        <div
            x-data="{
                currentStep: 0,
                completedSteps: [],
                totalSteps: 3,

                nextStep() {
                    if (this.currentStep < this.totalSteps - 1) {
                        this.markStepComplete(this.currentStep);
                        this.currentStep++;
                    }
                },

                prevStep() {
                    if (this.currentStep > 0) {
                        this.currentStep--;
                    }
                },

                markStepComplete(step) {
                    if (!this.completedSteps.includes(step)) {
                        this.completedSteps.push(step);
                    }
                },

                isStepComplete(step) {
                    return this.completedSteps.includes(step);
                },

                getStepStatus(step) {
                    if (step === this.currentStep) return 'current';
                    if (this.isStepComplete(step)) return 'complete';
                    return 'upcoming';
                },

                getProgressPercentage() {
                    return (this.currentStep / (this.totalSteps - 1)) * 100;
                }
            }"
            class="w-full"
        >
            <!-- Progress Bar -->
            <div class="mb-8">
                <div class="relative">
                    <div class="overflow-hidden h-2 text-xs flex rounded-full bg-gray-200">
                        <div
                            :style="'width: ' + getProgressPercentage() + '%'"
                            class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-600 transition-all duration-500"
                        ></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-600 mt-2">
                        <span>Step <span x-text="currentStep + 1"></span> of 3</span>
                        <span x-text="Math.round(getProgressPercentage()) + '% Complete'"></span>
                    </div>
                </div>
            </div>

            <!-- Step Navigation -->
            <nav class="mb-8">
                <ol class="flex items-center justify-between">
                    <li class="relative flex-1 pr-8">
                        <button type="button" @click="currentStep = 0" class="group w-full">
                            <div class="flex items-center">
                                <div
                                    class="relative flex h-10 w-10 items-center justify-center rounded-full border-2 transition-colors"
                                    :class="{
                                        'border-blue-600 bg-blue-600': getStepStatus(0) === 'current',
                                        'border-blue-600 bg-blue-600': getStepStatus(0) === 'complete',
                                        'border-gray-300 bg-white': getStepStatus(0) === 'upcoming'
                                    }"
                                >
                                    <template x-if="getStepStatus(0) === 'complete'">
                                        <svg class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                        </svg>
                                    </template>
                                    <template x-if="getStepStatus(0) !== 'complete'">
                                        <span
                                            :class="{
                                                'text-white': getStepStatus(0) === 'current',
                                                'text-gray-500': getStepStatus(0) === 'upcoming'
                                            }"
                                            class="font-semibold"
                                        >1</span>
                                    </template>
                                </div>
                                <div class="ml-3 text-left">
                                    <p class="text-sm font-medium" :class="getStepStatus(0) === 'current' ? 'text-blue-600' : 'text-gray-900'">Personal Info</p>
                                </div>
                            </div>
                        </button>
                        <div class="absolute top-5 right-0 h-0.5 w-full bg-gray-300" :class="{'bg-blue-600': isStepComplete(0)}"></div>
                    </li>

                    <li class="relative flex-1 px-4">
                        <button type="button" @click="isStepComplete(0) && (currentStep = 1)" class="group w-full">
                            <div class="flex items-center">
                                <div
                                    class="relative flex h-10 w-10 items-center justify-center rounded-full border-2 transition-colors"
                                    :class="{
                                        'border-blue-600 bg-blue-600': getStepStatus(1) === 'current',
                                        'border-blue-600 bg-blue-600': getStepStatus(1) === 'complete',
                                        'border-gray-300 bg-white': getStepStatus(1) === 'upcoming'
                                    }"
                                >
                                    <template x-if="getStepStatus(1) === 'complete'">
                                        <svg class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                        </svg>
                                    </template>
                                    <template x-if="getStepStatus(1) !== 'complete'">
                                        <span
                                            :class="{
                                                'text-white': getStepStatus(1) === 'current',
                                                'text-gray-500': getStepStatus(1) === 'upcoming'
                                            }"
                                            class="font-semibold"
                                        >2</span>
                                    </template>
                                </div>
                                <div class="ml-3 text-left">
                                    <p class="text-sm font-medium" :class="getStepStatus(1) === 'current' ? 'text-blue-600' : 'text-gray-900'">Preferences</p>
                                </div>
                            </div>
                        </button>
                        <div class="absolute top-5 right-0 h-0.5 w-full bg-gray-300" :class="{'bg-blue-600': isStepComplete(1)}"></div>
                    </li>

                    <li class="relative flex-1 pl-8">
                        <button type="button" @click="isStepComplete(1) && (currentStep = 2)" class="group w-full">
                            <div class="flex items-center">
                                <div
                                    class="relative flex h-10 w-10 items-center justify-center rounded-full border-2 transition-colors"
                                    :class="{
                                        'border-blue-600 bg-blue-600': getStepStatus(2) === 'current',
                                        'border-blue-600 bg-blue-600': getStepStatus(2) === 'complete',
                                        'border-gray-300 bg-white': getStepStatus(2) === 'upcoming'
                                    }"
                                >
                                    <template x-if="getStepStatus(2) === 'complete'">
                                        <svg class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                                        </svg>
                                    </template>
                                    <template x-if="getStepStatus(2) !== 'complete'">
                                        <span
                                            :class="{
                                                'text-white': getStepStatus(2) === 'current',
                                                'text-gray-500': getStepStatus(2) === 'upcoming'
                                            }"
                                            class="font-semibold"
                                        >3</span>
                                    </template>
                                </div>
                                <div class="ml-3 text-left">
                                    <p class="text-sm font-medium" :class="getStepStatus(2) === 'current' ? 'text-blue-600' : 'text-gray-900'">Review</p>
                                </div>
                            </div>
                        </button>
                    </li>
                </ol>
            </nav>

            <!-- Step Content -->
            <div class="bg-gray-50 rounded-lg border border-gray-200 p-6 mb-6 min-h-[300px]">
                <div x-show="currentStep === 0">
                    <h3 class="text-lg font-semibold mb-4">Step 1: Personal Information</h3>
                    <div class="space-y-4">
                        <input type="text" placeholder="Full Name" class="w-full px-3 py-2 border rounded-lg">
                        <input type="email" placeholder="Email Address" class="w-full px-3 py-2 border rounded-lg">
                        <input type="tel" placeholder="Phone Number" class="w-full px-3 py-2 border rounded-lg">
                    </div>
                </div>

                <div x-show="currentStep === 1">
                    <h3 class="text-lg font-semibold mb-4">Step 2: Preferences</h3>
                    <div class="space-y-4">
                        <select class="w-full px-3 py-2 border rounded-lg">
                            <option>Select your program...</option>
                            <option>BS Computer Science</option>
                            <option>BS Information Technology</option>
                        </select>
                        <select class="w-full px-3 py-2 border rounded-lg">
                            <option>Select year level...</option>
                            <option>1st Year</option>
                            <option>2nd Year</option>
                            <option>3rd Year</option>
                            <option>4th Year</option>
                        </select>
                    </div>
                </div>

                <div x-show="currentStep === 2">
                    <h3 class="text-lg font-semibold mb-4">Step 3: Review & Submit</h3>
                    <div class="bg-white rounded-lg p-4">
                        <p class="text-sm text-gray-700">Please review your information before submitting.</p>
                        <div class="mt-4 space-y-2">
                            <p class="text-sm"><strong>Name:</strong> John Doe</p>
                            <p class="text-sm"><strong>Email:</strong> john.doe@example.com</p>
                            <p class="text-sm"><strong>Program:</strong> BS Computer Science</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="flex justify-between">
                <button
                    @click="prevStep()"
                    x-show="currentStep > 0"
                    class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"
                >
                    <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    Previous
                </button>

                <button
                    @click="nextStep()"
                    x-show="currentStep < totalSteps - 1"
                    class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                >
                    Next
                    <svg class="w-5 h-5 inline ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>

                <button
                    x-show="currentStep === totalSteps - 1"
                    @click="alert('Wizard completed!')"
                    class="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700"
                >
                    <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                    </svg>
                    Complete
                </button>
            </div>
        </div>
    </div>

    <!-- Rich Text Editor Demo -->
    <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-xl font-semibold mb-4">Rich Text Editor Component</h3>
        <p class="text-gray-600 mb-6">WYSIWYG content editing with formatting toolbar:</p>

        <!-- Rich Text Editor -->
        {% include "components/molecules/rich_text_editor.html" with
            label="Course Description"
            name="description"
            placeholder="Enter a detailed course description..."
            help_text="Use the toolbar above to format your text"
            min_height="lg"
        %}

        <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
            <h4 class="font-semibold text-blue-900 mb-2">Features:</h4>
            <ul class="text-sm text-blue-800 space-y-1 list-disc list-inside">
                <li>Bold, Italic, Underline, Strikethrough formatting</li>
                <li>Heading styles (H1, H2, H3)</li>
                <li>Bulleted and numbered lists</li>
                <li>Insert links and images</li>
                <li>Code blocks</li>
                <li>Character and word count</li>
                <li>Keyboard shortcuts (Ctrl+B, Ctrl+I, Ctrl+U)</li>
                <li>Responsive toolbar</li>
            </ul>
        </div>
    </div>

</div>
{% endblock %}
