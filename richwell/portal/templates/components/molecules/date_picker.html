{# Date Picker Molecule - For selecting dates #}
{#
  Props:
  - label: field label (required)
  - name: input name attribute (required)
  - id: input id attribute (optional, defaults to name)
  - value: current date value in YYYY-MM-DD format (optional)
  - placeholder: placeholder text (optional, default: "Select date")
  - required: whether field is required (default: False)
  - disabled: whether field is disabled (default: False)
  - min_date: minimum selectable date in YYYY-MM-DD format (optional)
  - max_date: maximum selectable date in YYYY-MM-DD format (optional)
  - error: error message to display (optional)
  - help_text: helper text below field (optional)
  - icon: show calendar icon (default: True)
  - autocomplete: autocomplete attribute value (optional)

  Usage:
  {% include "components/molecules/date_picker.html" with label="Start Date" name="start_date" required=True %}
  {% include "components/molecules/date_picker.html" with label="Birth Date" name="birth_date" max_date="2020-01-01" %}
#}

{% load static %}

{# Set defaults #}
{% with
  input_id=id|default:name
  input_value=value|default:""
  input_placeholder=placeholder|default:"Select date"
  input_required=required|default:False
  input_disabled=disabled|default:False
  input_min=min_date|default:""
  input_max=max_date|default:""
  input_error=error|default:""
  input_help=help_text|default:""
  show_icon=icon|default:True
  input_autocomplete=autocomplete|default:""
%}

<div class="w-full" x-data="{ focused: false }">
  {# Label #}
  <label for="{{ input_id }}" class="block text-sm font-medium text-gray-700 mb-2">
    {{ label }}
    {% if input_required %}
      <span class="text-red-500">*</span>
    {% endif %}
  </label>

  {# Date Input Container #}
  <div class="relative">
    {# Calendar Icon #}
    {% if show_icon %}
    <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
      </svg>
    </div>
    {% endif %}

    {# Date Input #}
    <input
      type="date"
      id="{{ input_id }}"
      name="{{ name }}"
      {% if input_value %}value="{{ input_value }}"{% endif %}
      placeholder="{{ input_placeholder }}"
      {% if input_required %}required{% endif %}
      {% if input_disabled %}disabled{% endif %}
      {% if input_min %}min="{{ input_min }}"{% endif %}
      {% if input_max %}max="{{ input_max }}"{% endif %}
      {% if input_autocomplete %}autocomplete="{{ input_autocomplete }}"{% endif %}
      @focus="focused = true"
      @blur="focused = false"
      class="block w-full {% if show_icon %}pl-10{% else %}pl-3{% endif %} pr-3 py-2.5 border rounded-lg text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition
        {% if input_error %}border-red-300 text-red-900 placeholder-red-300 focus:ring-red-500{% else %}border-gray-300{% endif %}
        {% if input_disabled %}bg-gray-100 cursor-not-allowed text-gray-500{% else %}bg-white{% endif %}"
      :class="{ 'ring-2 ring-blue-500 border-transparent': focused }"
    />
  </div>

  {# Error Message #}
  {% if input_error %}
  <p class="mt-2 text-sm text-red-600 flex items-center">
    <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
    </svg>
    {{ input_error }}
  </p>
  {% endif %}

  {# Help Text #}
  {% if input_help and not input_error %}
  <p class="mt-2 text-sm text-gray-500">{{ input_help }}</p>
  {% endif %}
</div>

{% endwith %}
