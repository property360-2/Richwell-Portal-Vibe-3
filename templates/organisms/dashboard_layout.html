{% extends "base.html" %}
{% load static %}
{% block content %}
<nav class="bg-indigo-600 text-white px-6 py-3 flex justify-between items-center">
  <div class="flex items-center gap-4">
    <a href="/dashboard/" class="font-semibold hover:underline">Home</a>
    <a href="/dashboard/courses/" class="hover:underline">Courses</a>
    <a href="/dashboard/subjects/" class="hover:underline">Subjects</a>
    <a href="/dashboard/sections/" class="hover:underline">Sections</a>
  </div>
  <button id="logoutBtn" class="bg-white text-indigo-700 px-4 py-2 rounded-lg hover:bg-gray-100">Logout</button>
</nav>

<main class="p-6 bg-gray-50 min-h-screen">
  {% block dashboard_content %}{% endblock %}
</main>
<script>
document.getElementById("logoutBtn").addEventListener("click", async () => {
  const refresh = localStorage.getItem("refresh");

  try {
    if (refresh) {
      await fetch("/auth/logout/", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ refresh }),
      });
    }
  } catch (err) {
    console.warn("Logout API failed", err);
  } finally {
    // Clear both session and JWT
    await fetch("/logout/", { method: "GET" });
    localStorage.clear();
    window.location.href = "/";
  }
});
</script>

{% endblock %}
