{% extends "base.html" %}
{% block title %}Student Load Report{% endblock %}
{% block content %}
<div class="container mx-auto px-4 py-8">
    <a href="{% url 'reports:dashboard' %}" class="text-blue-600 hover:text-blue-800 font-semibold mb-4 inline-block">‚Üê Back</a>
    <h1 class="text-3xl font-bold mb-6">Student Load Summary</h1>
    
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
        <form method="get" class="grid grid-cols-3 gap-4">
            <select name="term" class="px-3 py-2 border rounded-lg"><option value="">All Terms</option>{% for term in terms %}<option value="{{ term.id }}" {% if term.id == selected_term %}selected{% endif %}>{{ term.name }}</option>{% endfor %}</select>
            <select name="program" class="px-3 py-2 border rounded-lg"><option value="">All Programs</option>{% for program in programs %}<option value="{{ program.id }}" {% if program.id == selected_program %}selected{% endif %}>{{ program.name }}</option>{% endfor %}</select>
            <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Filter</button>
        </form>
    </div>

    <div class="grid grid-cols-3 gap-6 mb-6">
        <div class="bg-blue-50 p-6 rounded-xl"><p class="text-sm text-gray-600">Average Units</p><p class="text-4xl font-bold text-blue-600">{{ avg_units }}</p></div>
        <div class="bg-green-50 p-6 rounded-xl"><p class="text-sm text-gray-600">Max Units</p><p class="text-4xl font-bold text-green-600">{{ max_units }}</p></div>
        <div class="bg-purple-50 p-6 rounded-xl"><p class="text-sm text-gray-600">Min Units</p><p class="text-4xl font-bold text-purple-600">{{ min_units }}</p></div>
    </div>

    <div class="bg-white rounded-xl shadow-lg overflow-hidden">
        <table class="w-full">
            <thead><tr class="bg-gray-50"><th class="text-left py-3 px-4">Student</th><th class="text-left py-3 px-4">Program</th><th class="text-center py-3 px-4">Subjects</th><th class="text-center py-3 px-4">Total Units</th></tr></thead>
            <tbody>
                {% for load in student_loads %}
                <tr class="border-b hover:bg-gray-50"><td class="py-3 px-4 font-semibold">{{ load.student.user.get_full_name }}</td><td class="py-3 px-4 text-sm">{{ load.student.program.name }}</td><td class="py-3 px-4 text-center">{{ load.subject_count }}</td><td class="py-3 px-4 text-center font-bold text-blue-600">{{ load.total_units }}</td></tr>
                {% empty %}
                <tr><td colspan="4" class="py-12 text-center text-gray-500">No data found</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
